function d3Line(){function n(a){return a.each(function(n){var g=n.map(function(n){return n.data}),tt,it,b,nt,k,v,d,y;e=e||i;o=o||r;n=n.map(function(n,t){return n.data=n.data.map(function(n){return n.series=t,n}),n});i.domain(d3.extent(d3.merge(g),function(n){return n[0]})).range([0,s-t.left-t.right]);r.domain(d3.extent(d3.merge(g),function(n){return n[1]})).range([h-t.top-t.bottom,0]);var p=d3.merge(n.map(function(n,t){return n.data.map(function(u,f){var e=n.label+"-"+u[0];return[i(u[0]),r(u[1]),t,f]})})),a=d3.select(this).selectAll("g.d3line").data([n]),w=a.enter().append("g").attr("class","d3line").append("g");w.append("g").attr("class","lines");w.append("g").attr("class","point-clips");w.append("g").attr("class","point-paths");tt=a.select("g").attr("transform","translate("+t.left+","+t.top+")");it=w.append("g").attr("class","voronoi-clip").append("clipPath").attr("id","voronoi-clip-path-"+u).append("rect");a.select(".voronoi-clip rect").attr("x",-10).attr("y",-10).attr("width",s-t.left-t.right+20).attr("height",h-t.top-t.bottom+20);a.select(".point-paths").attr("clip-path","url(#voronoi-clip-path-"+u+")");b=a.select(".point-clips").selectAll(".clip-path").data(p);b.enter().append("clipPath").attr("class","clip-path").append("circle").attr("r",25);b.exit().remove();b.attr("id",function(n){return"clip-"+u+"-"+n[2]+"-"+n[3]}).attr("transform",function(n){return"translate("+n[0]+","+n[1]+")"});nt=d3.geom.voronoi(p).map(function(n,t){return{data:n,series:p[t][2],point:p[t][3]}});k=a.select(".point-paths").selectAll("path").data(nt);k.enter().append("path").attr("class",function(n,t){return"path-"+t});k.exit().remove();k.attr("clip-path",function(n){return"url(#clip-"+u+"-"+n.series+"-"+n.point+")"}).attr("d",function(n){return"M"+n.data.join(",")+"Z"}).on("mouseover",function(u){f.pointMouseover({point:n[u.series].data[u.point],series:n[u.series],pos:[i(n[u.series].data[u.point][0])+t.left,r(n[u.series].data[u.point][1])+t.top],pointIndex:u.point,seriesIndex:u.series})}).on("mouseout",function(t){f.pointMouseout({point:t,series:n[t.series],pointIndex:t.point,seriesIndex:t.series})});f.on("pointMouseover.point",function(n){a.select(".line-"+n.seriesIndex+" .point-"+n.pointIndex).classed("hover",!0)});f.on("pointMouseout.point",function(n){a.select(".line-"+n.seriesIndex+" .point-"+n.pointIndex).classed("hover",!1)});v=a.select(".lines").selectAll(".line").data(function(n){return n},function(n){return n.label});v.enter().append("g").style("stroke-opacity",1e-6).style("fill-opacity",1e-6);d3.transition(v.exit()).style("stroke-opacity",1e-6).style("fill-opacity",1e-6).remove();v.attr("class",function(n,t){return"line line-"+t}).classed("hover",function(n){return n.hover}).style("fill",function(n,t){return c[t%10]}).style("stroke",function(n,t){return c[t%10]});d3.transition(v).style("stroke-opacity",1).style("fill-opacity",.5);d=v.selectAll("path").data(function(n){return[n.data]});d.enter().append("path").attr("d",d3.svg.line().x(function(n){return e(n[0])}).y(function(n){return o(n[1])}));d.exit().remove();d3.transition(d).attr("d",d3.svg.line().x(function(n){return i(n[0])}).y(function(n){return r(n[1])}));y=v.selectAll("circle.point").data(function(n){return n.data});y.enter().append("circle").attr("cx",function(n){return e(n[0])}).attr("cy",function(n){return o(n[1])});y.exit().remove();y.attr("class",function(n,t){return"point point-"+t});d3.transition(y).attr("cx",function(n){return i(n[0])}).attr("cy",function(n){return r(n[1])}).attr("r",l())}),e=i,o=r,n}var t={top:0,right:0,bottom:0,left:0},s=960,h=500,l=function(){return 2.5},c=d3.scale.category10().range(),u=Math.floor(Math.random()*1e4),i=d3.scale.linear(),r=d3.scale.linear(),f=d3.dispatch("pointMouseover","pointMouseout"),e,o;return n.dispatch=f,n.margin=function(i){return arguments.length?(t=i,n):t},n.width=function(t){return arguments.length?(s=t,n):s},n.height=function(t){return arguments.length?(h=t,n):h},n.dotRadius=function(t){return arguments.length?(l=d3.functor(t),n):l},n.color=function(t){return arguments.length?(c=t,n):c},n.id=function(t){return arguments.length?(u=t,n):u},n}