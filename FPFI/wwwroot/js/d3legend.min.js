function d3Legend(){function n(e){return e.each(function(n){var l=d3.select(this).selectAll("g.legend").data([n]),y=l.enter().append("g").attr("class","legend").append("g"),a=l.select("g").attr("transform","translate("+t.left+","+t.top+")"),o=a.selectAll(".series").data(function(n){return n}),v=o.enter().append("g").attr("class","series").on("click",function(n,t){u.legendClick(n,t)}).on("mouseover",function(n,t){u.legendMouseover(n,t)}).on("mouseout",function(n,t){u.legendMouseout(n,t)});v.append("circle").style("fill",function(n,t){return n.color||r[t%10]}).style("stroke",function(n,t){return n.color||r[t%10]}).attr("r",5);v.append("text").text(function(n){return n.label}).attr("text-anchor","start").attr("dy",".32em").attr("dx","8");o.classed("disabled",function(n){return n.disabled});o.exit().remove();var h=5,e=5,c=0,s;o.attr("transform",function(){var n=d3.select(this).select("text").node().getComputedTextLength()+28;return s=e,i<t.left+t.right+s+n&&(e=s=5,h+=20),e+=n,e>c&&(c=e),"translate("+s+","+h+")"});a.attr("transform","translate("+(i-t.right-c)+","+t.top+")");f=t.top+t.bottom+h+15}),n}var t={top:5,right:0,bottom:5,left:10},i=400,f=20,r=d3.scale.category10().range(),u=d3.dispatch("legendClick","legendMouseover","legendMouseout");return n.dispatch=u,n.margin=function(i){return arguments.length?(t=i,n):t},n.width=function(t){return arguments.length?(i=t,n):i},n.height=function(t){return arguments.length?(f=t,n):f},n.color=function(t){return arguments.length?(r=t,n):r},n}